/* ANÁLISE DA FREQUENCIA DOS ALUNOS QUE ESTÃO ANTES E DEPOIS DO PERÍODO DO ANO 
LETIVO, DE ACORDO COM A TABELA/CALENDÁRIO, EXCLUINDO DA CONSULTA OS ALUNOS QUE ESTÃO NO PERÍODO DE RECUPERAÇÃO
SE FOR FORA DOS 200 DIAS LETIVOS */

SELECT *
FROM caetes.frequency_item
WHERE date < '2021-02-17 21:00:00-03'
  AND date NOT BETWEEN '2021-12-21 21:00:00-03' AND '2021-12-22 21:00:00-03' 
 /* A CONDIÇÃO ACIMA EXCLUI DA CONSULTA A FREQUENCIA REFERENTE A ESTE 
 PERÍODO QUE CORRESPONDE AS AULAS DE RECUPERAÇÃO CONSTANTE NA TABELA HOLIDAY */

UNION ALL

SELECT *
FROM caetes.frequency_item
WHERE date BETWEEN '2021-12-21 21:00:00-03' AND '2021-12-31 21:00:00-03'
 AND date NOT BETWEEN '2021-12-21 21:00:00-03' AND '2021-12-22 21:00:00-03' 
ORDER BY date ASC 

/* O CÓDIGO ACIMA É REFERENTE AO RESTANTE DO ANO APENAS EXCLUINDO O PERÍODO REFERENTE
AS AULAS DE RECUPERAÇÃO, SE OUVER E ESTIVER FORA DOS 200 DIAS LETIVOS */ 

/* CÓDIGO DE CONSULTA PARA TODOS OS FERIADOS OU DIAS QUE NÃO OUVERAM AULAS, DIVIDIDO EM 
DATAS FIXAS OU PERÍODOS */
SELECT *
FROM caetes.frequency_item
WHERE date IN ('2020-12-31 21:00:00-03', '2021-04-20 21:00:00-03','2021-04-30 21:00:00-03',
			  '2021-09-06 21:00:00-03', '2021-10-11 21:00:00-03', '2021-11-01 21:00:00-03',
			  '2021-11-14 21:00:00-03', '2021-12-30 21:00:00-03')			  
UNION ALL
SELECT *
FROM caetes.frequency_item
WHERE date BETWEEN '2021-12-24 21:00:00-03' AND '2021-12-25 21:00:00-03'
ORDER BY date ASC	
		

